# 2025-12-01 スッキリわかるSQL入門 第4版②
## 第2部 SQLを使いこなそう
### Chapter5 式と関数
#### 5.1 式と演算子
##### 5.1.1 式の種類
結果が真や偽にならない式を計算式と呼ぶ。
##### 5.1.2 選択列リストで計算式を使う
SELECT文において、SELECTのすぐ後ろに指定するのが選択列リスト。選択列リストは、結果表にどのような列を出力するかを指定する役割がある。
▼選択列リストへのさまざまな指定
```SQL
SELECT 出金額,--列名
	   出金額 + 100,--計算式
	   'SQL' --固定値
   FROM 家計簿
```

**選択列リストへの指定と結果**
列名→列の内容がそのまま出力される
計算式→計算式の評価結果が出力される
固定値→固定値（リテラル）がそのまま出力される

##### 5.1.3 データの代わりに計算式を使う
▼INSERT文での計算式の利用
```SQL
INSERT INTO 家計簿（出金額）
VALUES (1000 + 105)
```
▼UPDATE文での計算式の利用（列指定を含む）
```SQL
UPDATE 家計簿
SET 出金額 = 出金額 + 100
```
##### 5.1.4 式が評価されるしくみ
**DBMSによる処理の原則**
- DBMSは、テーブル内の各行を1行ずつ順番に処理していく。
- 式の評価なども、各行で行われる。
#### 5.2 さまざまな演算子
##### 5.2.1 基本の算術演算子

| 演算子  | 使い方          | 説明           |
| ---- | ------------ | ------------ |
| ＋    | 数値＋数値        | 数値同士で足し算をする  |
|      | 日付＋数値        | 日付を指定日数だけ進める |
| ー    | 数値ー数値        | 数値同士で引き算をする  |
|      | 日付ー数値        | 日付を指定日数だけ戻す  |
|      | 日付ー日付        | 日付の差の日数を得る   |
| *    | 数値 * 数値      | 数値同士で掛け算をする  |
| /    | 数値 / 数値      | 数値同士で割り算     |
| \|\| | 文字列 \|\| 文字列 | 文字列を連結する     |

##### 5.2.2 CASE演算子 ー 値を変換する
CASE演算子は、列の値や条件式を評価し、その結果に応じて値を自由に変換してくれる。
**▼CASE演算子の利用構文（１）**
```SQL
CASE 評価する列や式 WHEN 値1 THEN 値1のときに返す値
				　WHEN 値2 THEN 値2のときに返す値
				　ELSE デフォルト値
END
```
▼CASE演算子を使ったSELECT文
```SQL
SELECT 費目, 出金額,
CASE 費目 WHEN '居住費' THEN '固定費'
		 WHEN '水道光熱費' THEN '固定費'
		 ELSE '変動費'
	END AS 出費の分類
	FROM 家計簿 WHERE 出金額 > 0
```

▼CASE演算子の利用構文(2)
```SQL
CASE WHEN 条件1 THEN 条件1のときに返す値
	 WHEN 条件2 THEN 条件2のときに返す値
	 ELSE デフォルト値
END
```
CASEのすぐ後ろに列名や式を記述しない代わりに、WHENの後ろには値ではなく条件式を指定する。
▼CASE演算子を使ったSELECT文(2)
```SQL
SELECT 費目, 入金額,
CASE WHEN 入金額 < 5000 THEN 'お小遣い'
	 WHEN 入金額 < 10000 THEN '一時収入'
	 WHEN 入金額 < 30000 THEN 'お給料'
	 ELSE '想定外の収入です'
END AS 収入の分類
FROM 家計簿
WHERE 入金額 > 0
```

CASE演算子は、式の結果に応じて複数のパターンの結果を得たい場合に有効。
#### 5.3 さまざまな関数
#### 5.4 文字列にまつわる関数
#### 5.5 数値にまつわる関数
#### 5.6 日付にまつわる関数
#### 5.7 変換にまつわる関数
#### 5.8 この章のまとめ


### Chapter6 集計とグループ化
### Chapter7 副問い合わせ
### Chapter8 複数テーブルの結合